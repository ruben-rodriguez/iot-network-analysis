PUT _index_template/joy_template
{
  "index_patterns": ["joy*"],
  "template": {
    "settings": {
      "number_of_shards": 1
    },
    "mappings": {
      "_source": {
        "enabled": true
      },
      "properties": {
        "da": { "type": "ip"},
        "sa": { "type": "ip"},
        "geo" : {
          "properties" : {
              "as_org" : { "type" : "keyword" },
              "asn" : { "type" : "keyword" },
              "country_code2" : { "type" : "keyword" },
              "country_code3" : { "type" : "keyword" },
              "country_name" : { "type" : "keyword" },
              "continent_code" : { "type" : "keyword" },
              "city_name" : { "type" : "keyword" },
              "region_code" : { "type" : "keyword" },
              "region_name" : { "type" : "keyword" },
              "postal_code" : { "type" : "keyword" },
              "ip" : { "type" : "ip" },
              "location" : { "type" : "geo_point" },
              "latitude" : { "type" : "float" },
              "longitude" : { "type" : "float" },
              "timezone" : { "type" : "keyword" }
          }
      }
      }
    }
  },
  "priority": 500,
  "version": 3,
  "_meta": {
    "description": "my custom"
  }
}


GET joy/_search
{
  "size": 0,
  "aggs": {
    "table": {
      "composite": {
        "size": 10,
        "sources": [
          {"stk1": {"terms": {"field": "da"}}},
          {"stk2": {"terms": {"field": "dns.qn.keyword"}}}
        ]
      }
    }
  }
}